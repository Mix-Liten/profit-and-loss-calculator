<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Profit and Loss Calculator</title>
</head>
<body>
    <form>
        買入個股成交價：<input type="number" autocomplete="off" step="0.1" id="a">
        股數：<input type="number" autocomplete="off" value="1000" step="1000" id="aa"><br>
        賣出個股成交價：<input type="number" autocomplete="off" step="0.1" id="b">
        股數：<input type="number" autocomplete="off" value="1000" step="1000" id="bb"><br>
    </form>

    <br>
    <hr>

    <table id="table" style="width: 100%;"></table>

    <script>
        handleInput = () => {
            const a = Number(document.getElementById('a').value);
            const b = Number(document.getElementById('b').value);
            const aa = Number(document.getElementById('aa').value);
            const bb = Number(document.getElementById('bb').value);

            if (!a || !b || !aa || !bb) {
                return;
            }

            const x = 0.1425 * 0.01;
            const y = 0.3 * 0.01;
            const z = 20;

            const content = Array(z + 1)
                .fill('')
                .map((v, i) => {
                    return i - z / 2;
                })
                .map((r, i) => {
                    const c = ((b + r) * bb - (b + r) * bb * (x + y)) - (a * aa + a * aa * x);
                    const d = c / (a * aa) * 100;
                    const e = r === 0 ? 'gold' : r === a - b ? 'paleturquoise' : '';

                    return `
                        <tr style="background: ${e};">
                            <td style="text-align: center;">
                                ${(b + r).toFixed(2)}
                            </td>
                            <td style="text-align: center; color: ${c > 0 ? 'red' : 'green'};">
                                ${c.toFixed(2)}
                            </td>
                            <td style="text-align: center; color: ${c > 0 ? 'red' : 'green'};">
                                ${d.toFixed(2)}%
                            </td>
                        </tr>
                    `;
                })
                .join('');

            const table = `
                <thead>
                    <tr style="height: 50px;">
                        <th>
                            賣出
                        </th>
                        <th>
                            獲利
                        </th>
                        <th>
                            獲利率
                        </th>
                    </tr>
                </thead>
                <tbody id="content">
                    ${content}
                </tbody>
            `;

            document.getElementById('table').innerHTML = table;
        };

        document.addEventListener('input', handleInput);
    </script>
</body>
</html>
